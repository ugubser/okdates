<div class="event-creation-container" *ngIf="event">
  <h1>{{ isCreatingNew ? 'Create New Event' : 'Edit Event' }}</h1>
  
  <form [formGroup]="eventForm" (ngSubmit)="saveEvent()">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Event Title (optional)</mat-label>
      <input matInput formControlName="title" placeholder="e.g., Team Dinner">
      <mat-hint>Give your event a name so participants know what it's for</mat-hint>
    </mat-form-field>
    
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Description (optional)</mat-label>
      <textarea
        matInput
        formControlName="description"
        placeholder="Add details about your event..."
        rows="4">
      </textarea>
      <mat-hint>Add any additional information participants should know</mat-hint>
    </mat-form-field>

    <div class="time-fields">
      <h3>Event Time (optional)</h3>
      <p class="time-hint">Set a default time range for your event</p>

      <div class="time-inputs">
        <mat-form-field appearance="outline">
          <mat-label>Start Time</mat-label>
          <input
            matInput
            placeholder="HH:MM"
            formControlName="startTime"
            [ngxTimepicker]="startPicker"
            readonly
          >
          <button
            mat-icon-button
            matSuffix
            (click)="startPicker.open()"
            type="button">
            <mat-icon>access_time</mat-icon>
          </button>
          <ngx-material-timepicker #startPicker></ngx-material-timepicker>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>End Time</mat-label>
          <input
            matInput
            placeholder="HH:MM"
            formControlName="endTime"
            [ngxTimepicker]="endPicker"
            readonly
          >
          <button
            mat-icon-button
            matSuffix
            (click)="endPicker.open()"
            type="button">
            <mat-icon>access_time</mat-icon>
          </button>
          <ngx-material-timepicker #endPicker></ngx-material-timepicker>
        </mat-form-field>
      </div>
    </div>
    
    <div class="link-section">
      <h3>Share this link with participants</h3>
      <div class="link-container">
        <span class="event-link">{{ window.location.origin }}/event/{{ eventId }}/view</span>
        <button 
          mat-icon-button 
          color="primary" 
          type="button"
          (click)="copyEventLink()"
          matTooltip="Copy to clipboard">
          <mat-icon>content_copy</mat-icon>
        </button>
      </div>
      <p class="hint">This link will be available after you save the event</p>
    </div>
    
    <div class="link-section admin-link-section" *ngIf="event?.adminKey">
      <h3>Administrator Link</h3>
      <p class="admin-hint">Use this link to edit the event later. Keep it private!</p>
      <div class="link-container">
        <span class="event-link admin-link">{{ window.location.origin }}/event/{{ eventId }}/admin/{{ event.adminKey }}</span>
        <button 
          mat-icon-button 
          color="accent" 
          type="button"
          (click)="copyAdminLink()"
          matTooltip="Copy to clipboard">
          <mat-icon>content_copy</mat-icon>
        </button>
      </div>
      <p class="warning">Save this link! It's the only way to edit your event later.</p>
    </div>
    
    <div class="action-buttons">
      <button 
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="!eventForm.valid || isSaving">
        {{ isSaving ? 'Saving...' : 'Save & Continue' }}
      </button>
      
      <button
        mat-button
        type="button"
        [routerLink]="['/event', eventId, 'view']"
        *ngIf="!isCreatingNew">
        Cancel Changes
      </button>
    </div>
  </form>
</div>

<div class="loading-container" *ngIf="!event">
  <mat-spinner></mat-spinner>
</div>